(this.webpackJsonp2048=this.webpackJsonp2048||[]).push([[0],{15:function(e,t,i){},16:function(e,t,i){},17:function(e,t,i){"use strict";i.r(t);var s=i(0),r=i(1),a=i.n(r),c=i(7),n=i.n(c),o=(i(15),i(2)),d=i(6),h=i(8),l=i(9),u="game2048",v=new(function(){function e(t){Object(h.a)(this,e),this.size=t;var i=localStorage.getItem(u);if(i){var s=JSON.parse(i);this.id=s.id,this.bestScore=s.bestScore,s.grid?(this.grid=s.grid,this.size=Math.sqrt(this.grid.length),this.score=s.score):this.createNewGame()}else this.id=0,this.bestScore=0,this.createNewGame()}return Object(l.a)(e,[{key:"createNewGame",value:function(){this.grid=new Array(this.size*this.size).fill(null),this.addTile(),this.addTile(),this.score=0,this.gameWon=!1,this.gameOver=!1,this.moved=!1}},{key:"addTile",value:function(){var e=Math.floor(Math.random()*(this.freeCellsList.length-1)),t=Math.random()<.9?2:4,i=this.freeCellsList[e].index;this.grid[i]={value:t,position:i,id:this.id++,merge:!1,remove:!1}}},{key:"isGameOver",value:function(){if(0!==this.freeCellsList.length)return!1;for(var e=0;e<this.size*this.size;e+=this.size)for(var t=0;t<this.size-1;t++)if(this.grid[e+t].value===this.grid[e+t+1].value)return!1;for(var i=0;i<this.size;i++)for(var s=0;s<this.size*this.size-this.size;s+=this.size)if(this.grid[i+s].value===this.grid[i+s+this.size].value)return!1;return!0}},{key:"makeStep",value:function(){var e,t,i,s,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(r){case 0:e=4,t=0,i=1;break;case 1:e=-1,t=this.size-1,i=this.size;break;case 2:e=-4,t=this.size*this.size-this.size,i=1;break;case 3:e=1,t=0,i=this.size}s=e;for(var a=function(i){return i*e+t},c=0;c<this.size;c++){for(var n=a(0),o=a(0),d=0;d<this.size;d++){var h=a(d);if(this.grid[h]){n!==h&&(this.grid[h].position=n,this.moved=!0);for(var l=d+1;l<this.size;){if(o=a(l),this.grid[o]){this.grid[o].value===this.grid[h].value&&(this.grid[o].position=this.grid[h].position,this.grid[h].merge=!0,this.grid[o].remove=!0,this.moved=!0,d=l);break}l++}n+=s}}t+=i}}},{key:"updateGrid",value:function(){var e=this;if(this.moved){var t=new Array(this.size*this.size).fill(null);this.grid.forEach((function(i){if(i){if(i.remove)return;i.merge&&(i.value*=2,i.merge=!1,e.score+=i.value,2048===i.value&&(e.gameWon=!0)),t[i.position]=i}})),this.grid=Object(o.a)(t),this.bestScore=this.score>this.bestScore?this.score:this.bestScore,this.addTile(),this.gameOver=this.isGameOver(),this.writeToStorage()}}},{key:"writeToStorage",value:function(){var e={};e.bestScore=this.bestScore,this.gameOver?(e.grid=null,e.score=null,e.id=null):(e.grid=this.grid,e.score=this.score,e.id=this.id),localStorage.setItem(u,JSON.stringify(e))}},{key:"freeCellsList",get:function(){return this.grid.map((function(e,t){return{index:t,value:e}})).filter((function(e){return null===e.value}))}}]),e}())(4),m=(i(16),0);function g(e){var t=e.content,i=e.callback;return Object(s.jsx)("button",{className:"button",onClick:i,children:t})}function b(e){var t=e.data;return Object(s.jsx)("div",{className:"gridItem gridItem-".concat(t.position," gridItemValue-").concat(t.value),children:t.value})}var j=function(){var e=Object(r.useState)(v.grid),t=Object(d.a)(e,2),i=t[0],a=t[1],c=Object(r.useState)(!1),n=Object(d.a)(c,2),h=n[0],l=n[1];Object(r.useEffect)((function(){var e=function(e){switch(e.keyCode){case 38:j(0);break;case 39:j(1);break;case 40:j(2);break;case 37:j(3)}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]);var u=function(){v.createNewGame(),l(!1),a(Object(o.a)(v.grid))},j=function(e){v.moved||(v.makeStep(e),a(Object(o.a)(v.grid)))};return console.log("render:"+m++),Object(s.jsxs)("div",{className:"game2048",children:[Object(s.jsxs)("div",{className:"header",children:[Object(s.jsx)("div",{className:"title",children:"Game 2048"}),Object(s.jsxs)("div",{className:"score",children:["Score: ",Object(s.jsx)("br",{}),v.score]}),Object(s.jsxs)("div",{className:"bestScore",children:["Best: ",Object(s.jsx)("br",{}),v.bestScore]}),Object(s.jsx)(g,{content:"New game",callback:u})]}),Object(s.jsxs)("div",{className:"gridContainer",onTransitionEnd:function(){v.moved&&(v.updateGrid(),a(Object(o.a)(v.grid)),v.moved=!1)},children:[i.map((function(e,t){return Object(s.jsx)("div",{className:"gridItem gridItem-".concat(t)},t)})),i.map((function(e){return e?Object(s.jsx)(b,{data:e},e.id):null})),v.gameWon&&!h?Object(s.jsxs)("div",{className:"gameStatus gameWon",children:[Object(s.jsx)("p",{className:"gameStatusTitle",children:"Game won!"}),Object(s.jsxs)("div",{children:[Object(s.jsx)(g,{content:"New game",callback:u}),Object(s.jsx)(g,{content:"Continue",callback:function(){l(!0)}})]})]}):null,v.gameOver?Object(s.jsxs)("div",{className:"gameStatus gameOver",children:[Object(s.jsx)("p",{className:"gameStatusTitle",children:"Game over"}),Object(s.jsx)("div",{children:Object(s.jsx)(g,{content:"New game",callback:u})})]}):null]})]})};var f=function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(j,{})})};n.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(f,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.ccd9dcae.chunk.js.map